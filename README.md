# ğŸ¥ Há»‡ Thá»‘ng Quáº£n LÃ½ KhÃ¡m Bá»‡nh# ğŸ¥### âœ¨ TÃ­nh NÄƒng Ná»•i Báº­t



Há»‡ thá»‘ng quáº£n lÃ½ khÃ¡m bá»‡nh chuyÃªn nghiá»‡p vá»›i giao diá»‡n CLI, há»— trá»£ quÃ©t QR code, bÃ¡o cÃ¡o Excel vÃ  há»‡ thá»‘ng lá»‹ch sá»­ khÃ¡m nÃ¢ng cao.### ğŸ¯ Core Features:

- âœ… **Quáº£n lÃ½ Ä‘áº§y Ä‘á»§**: Bá»‡nh nhÃ¢n, bÃ¡c sÄ©, phÃ²ng khÃ¡m, dá»‹ch vá»¥, tiáº¿p nháº­n

## âœ¨ TÃ­nh NÄƒng ChÃ­nh- âœ… **QR Code thÃ´ng minh**: Tá»± Ä‘á»™ng táº¡o bá»‡nh nhÃ¢n tá»« CCCD vá»›i phÃ¢n tÃ­ch thÃ´ng minh

- âœ… **PhÃ¢n quyá»n nÃ¢ng cao**: Há»‡ thá»‘ng Admin/User vá»›i menu riÃªng biá»‡t vÃ  tÃ­nh nÄƒng chuyÃªn biá»‡t

### ğŸ¯ Core Features:- âœ… **Tá»± Ä‘á»™ng hÃ³a**: GÃ¡n bÃ¡c sÄ© theo chuyÃªn khoa, táº¡o tÃ i khoáº£n bá»‡nh nhÃ¢n

- âœ… **Quáº£n lÃ½ toÃ n diá»‡n**: Bá»‡nh nhÃ¢n, bÃ¡c sÄ©, phÃ²ng khÃ¡m, dá»‹ch vá»¥, tiáº¿p nháº­n- âœ… **ğŸ†• Lá»‹ch sá»­ khÃ¡m nÃ¢ng cao**: Xem chi tiáº¿t, tÃ¬m kiáº¿m, thá»‘ng kÃª cho User role

- âœ… **QR Code thÃ´ng minh**: Tá»± Ä‘á»™ng táº¡o bá»‡nh nhÃ¢n tá»« CCCD vá»›i phÃ¢n tÃ­ch CCCD 12 sá»‘

- âœ… **PhÃ¢n quyá»n hoÃ n chá»‰nh**: Admin (quáº£n lÃ½) vÃ  User (bá»‡nh nhÃ¢n) vá»›i menu chuyÃªn biá»‡t### ğŸš€ NEW: BÃ¡o CÃ¡o & Xuáº¥t Excel ChuyÃªn Nghiá»‡p

- âœ… **Tá»± Ä‘á»™ng hÃ³a**: GÃ¡n bÃ¡c sÄ© theo chuyÃªn khoa, táº¡o tÃ i khoáº£n tá»± Ä‘á»™ng- ğŸ“Š **11 loáº¡i bÃ¡o cÃ¡o** Ä‘a dáº¡ng (danh sÃ¡ch, thá»‘ng kÃª, phÃ¢n tÃ­ch)

- ğŸ“ˆ **BÃ¡o cÃ¡o thá»‘ng kÃª tá»•ng há»£p** vá»›i phÃ¢n tÃ­ch chi tiáº¿t

### ğŸ“Š Há»‡ Thá»‘ng BÃ¡o CÃ¡o ChuyÃªn Nghiá»‡p:- ğŸ’° **BÃ¡o cÃ¡o doanh thu** theo dá»‹ch vá»¥ vá»›i ranking

- ğŸ“ˆ **11 loáº¡i bÃ¡o cÃ¡o** Ä‘a dáº¡ng vá»›i Excel styling- ğŸ“… **BÃ¡o cÃ¡o hoáº¡t Ä‘á»™ng hÃ ng ngÃ y** 

- ğŸ’° **BÃ¡o cÃ¡o doanh thu** theo dá»‹ch vá»¥ vá»›i ranking- ğŸ“‹ **BÃ¡o cÃ¡o tá»•ng há»£p Ä‘a trang** (5 sheets trong 1 file)

- ğŸ“‹ **BÃ¡o cÃ¡o tá»•ng há»£p** Ä‘a trang (5 sheets trong 1 file)- ğŸ¨ **Excel styling chuyÃªn nghiá»‡p** vá»›i openpyxl

- ğŸ—‚ï¸ **Tá»± Ä‘á»™ng quáº£n lÃ½ file** vÃ  dá»n dáº¹p- ğŸ“ **Quáº£n lÃ½ file tá»± Ä‘á»™ng** (má»Ÿ thÆ° má»¥c, dá»n dáº¹p file cÅ©)

- ğŸ’¾ **CSV fallback** khi khÃ´ng cÃ³ pandas

### ğŸ” Há»‡ Thá»‘ng Lá»‹ch Sá»­ KhÃ¡m NÃ¢ng Cao (User):- ğŸ—‚ï¸ **Cáº¥u trÃºc thÆ° má»¥c** cÃ³ tá»• chá»©c (reports/benh_nhan/, tiep_nhan/, etc.)

- ğŸ“‹ **Xem lá»‹ch sá»­ cÆ¡ báº£n**: Báº£ng thÃ´ng tin vá»›i thá»‘ng kÃª tá»•ng há»£p

- ğŸ” **Xem chi tiáº¿t nÃ¢ng cao**: TÃ¬m kiáº¿m, lá»c vÃ  xem tá»«ng láº§n khÃ¡m### ğŸ†• NEW: Há»‡ Thá»‘ng Lá»‹ch Sá»­ KhÃ¡m NÃ¢ng Cao (User Role)

- ğŸ“Š **Thá»‘ng kÃª cÃ¡ nhÃ¢n**: Tá»•ng sá»‘ láº§n khÃ¡m, chi phÃ­- ğŸ“‹ **Xem lá»‹ch sá»­ cÆ¡ báº£n**: Hiá»ƒn thá»‹ danh sÃ¡ch vá»›i báº£ng Ä‘á»‹nh dáº¡ng chuyÃªn nghiá»‡p

- ğŸ—“ï¸ **ThÃ´ng tin thá»i gian**: NgÃ y khÃ¡m chÃ­nh xÃ¡c tá»« database- ğŸ” **Xem lá»‹ch sá»­ chi tiáº¿t**: Menu con vá»›i nhiá»u tÃ¹y chá»n tÃ¬m kiáº¿m vÃ  lá»c

- ğŸ“Š **Thá»‘ng kÃª cÃ¡ nhÃ¢n**: Tá»•ng sá»‘ láº§n khÃ¡m, tá»•ng chi phÃ­ Ä‘Ã£ thanh toÃ¡n

## ğŸ“‹ YÃªu Cáº§u Há»‡ Thá»‘ng- ğŸ—“ï¸ **Hiá»ƒn thá»‹ ngÃ y khÃ¡m**: ThÃ´ng tin thá»i gian chÃ­nh xÃ¡c tá»« database

- ğŸ” **TÃ¬m kiáº¿m theo mÃ£**: Tra cá»©u nhanh theo mÃ£ tiáº¿p nháº­n

- **Python**: 3.8+ (khuyáº¿n nghá»‹ 3.10+)- ğŸ“ **Chi tiáº¿t tá»«ng láº§n khÃ¡m**: Xem Ä‘áº§y Ä‘á»§ thÃ´ng tin bá»‡nh nhÃ¢n, dá»‹ch vá»¥, bÃ¡c sÄ©

- **Database**: Microsoft SQL Server (LocalDB, Express, hoáº·c Full)- ğŸ¨ **Giao diá»‡n thÃ¢n thiá»‡n**: Text formatting thÃ´ng minh, cáº¯t ngáº¯n text dÃ i

- **Dependencies**: `pyodbc` (báº¯t buá»™c), `pandas + openpyxl` (khuyáº¿n nghá»‹)- ğŸ’¡ **Interactive**: Nháº­p STT Ä‘á»ƒ xem chi tiáº¿t, menu Ä‘iá»u hÆ°á»›ng trá»±c quanKhÃ¡m Bá»‡nh - NÃ‚NG CAP



## âš¡ CÃ i Äáº·t Nhanh# ğŸ¥ Há»‡ Thá»‘ng Quáº£n LÃ½ KhÃ¡m Bá»‡nh - NÃ‚NG CAP



### ğŸš€ Auto Setup (Khuyáº¿n nghá»‹)Há»‡ thá»‘ng quáº£n lÃ½ khÃ¡m bá»‡nh vá»›i giao diá»‡n CLI, há»— trá»£ quÃ©t QR code Ä‘Äƒng kÃ½ bá»‡nh nhÃ¢n, **tÃ­nh nÄƒng bÃ¡o cÃ¡o xuáº¥t Excel chuyÃªn nghiá»‡p**, vÃ  **há»‡ thá»‘ng lá»‹ch sá»­ khÃ¡m nÃ¢ng cao cho bá»‡nh nhÃ¢n**.



**Linux/macOS:**## âœ¨ TÃ­nh NÄƒng Ná»•i Báº­t

```bash

chmod +x setup_venv.sh run.sh### ğŸ¯ Core Features:

./setup_venv.sh    # Thiáº¿t láº­p má»™t láº§n- âœ… **Quáº£n lÃ½ Ä‘áº§y Ä‘á»§**: Bá»‡nh nhÃ¢n, bÃ¡c sÄ©, phÃ²ng khÃ¡m, dá»‹ch vá»¥, tiáº¿p nháº­n

./run.sh           # Cháº¡y á»©ng dá»¥ng- âœ… **QR Code thÃ´ng minh**: Tá»± Ä‘á»™ng táº¡o bá»‡nh nhÃ¢n tá»« CCCD vá»›i phÃ¢n tÃ­ch thÃ´ng minh

```- âœ… **PhÃ¢n quyá»n**: Há»‡ thá»‘ng Admin/User vá»›i menu riÃªng biá»‡t

- âœ… **Tá»± Ä‘á»™ng hÃ³a**: GÃ¡n bÃ¡c sÄ© theo chuyÃªn khoa, táº¡o tÃ i khoáº£n bá»‡nh nhÃ¢n

**Windows:**

```cmd### ğŸš€ NEW: BÃ¡o CÃ¡o & Xuáº¥t Excel ChuyÃªn Nghiá»‡p

setup_venv.bat     - ğŸ“Š **11 loáº¡i bÃ¡o cÃ¡o** Ä‘a dáº¡ng (danh sÃ¡ch, thá»‘ng kÃª, phÃ¢n tÃ­ch)

run.bat           - ğŸ“ˆ **BÃ¡o cÃ¡o thá»‘ng kÃª tá»•ng há»£p** vá»›i phÃ¢n tÃ­ch chi tiáº¿t

```- ğŸ’° **BÃ¡o cÃ¡o doanh thu** theo dá»‹ch vá»¥ vá»›i ranking

- ğŸ“… **BÃ¡o cÃ¡o hoáº¡t Ä‘á»™ng hÃ ng ngÃ y** 

### âš™ï¸ Cáº¥u hÃ¬nh Database- ğŸ“‹ **BÃ¡o cÃ¡o tá»•ng há»£p Ä‘a trang** (5 sheets trong 1 file)

Chá»‰nh sá»­a file `db.py`:- ğŸ¨ **Excel styling chuyÃªn nghiá»‡p** vá»›i openpyxl

```python- ğŸ“ **Quáº£n lÃ½ file tá»± Ä‘á»™ng** (má»Ÿ thÆ° má»¥c, dá»n dáº¹p file cÅ©)

conn_str = (- ğŸ’¾ **CSV fallback** khi khÃ´ng cÃ³ pandas

    "DRIVER={ODBC Driver 13 for SQL Server};"- ğŸ—‚ï¸ **Cáº¥u trÃºc thÆ° má»¥c** cÃ³ tá»• chá»©c (reports/benh_nhan/, tiep_nhan/, etc.)

    "SERVER=HOME\\GIOAN\\SQLEXPRESS;"    # Thay Ä‘á»•i server

    "DATABASE=DangKyKhamBenh;"### ğŸ§  QR Code Analysis:

    "Trusted_Connection=yes;"- ğŸ” **PhÃ¢n tÃ­ch CCCD 12 sá»‘** tá»± Ä‘á»™ng trÃ­ch xuáº¥t tá»‰nh, giá»›i tÃ­nh, nÄƒm sinh

    "TrustServerCertificate=yes;"- ğŸ“± **Multiple formats** há»— trá»£ nhiá»u Ä‘á»‹nh dáº¡ng QR khÃ¡c nhau

)- âš¡ **Validation** thÃ´ng minh vá»›i error handling

```

## ğŸ“‹ YÃªu Cáº§u Há»‡ Thá»‘ng

## ğŸ¯ HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

- **Python**: 3.8+ (khuyáº¿n nghá»‹ 3.10+)

### ğŸ” ÄÄƒng nháº­p:- **Database**: Microsoft SQL Server (LocalDB, Express, hoáº·c Full)

- **ğŸ‘¨â€ğŸ’¼ Admin**: `admin` / `admin` - Quáº£n lÃ½ toÃ n há»‡ thá»‘ng + BÃ¡o cÃ¡o- **OS**: Windows 10/11, macOS 10.15+, Linux (Ubuntu 18.04+)

- **ğŸ‘¤ User**: CCCD/password tá»± Ä‘á»™ng - ÄÄƒng kÃ½ khÃ¡m + Xem lá»‹ch sá»­

### Dependencies:

### ğŸ‘¨â€ğŸ’¼ Admin Menu:- **Báº¯t buá»™c**: `pyodbc` (database connection)

```- **Khuyáº¿n nghá»‹**: `pandas + openpyxl` (Excel export vá»›i styling)

ğŸ¥ MENU QUáº¢N TRá»Š VIÃŠN:- **TÃ¹y chá»n**: `numpy, matplotlib` (advanced analytics)

  1. ğŸ“‹ Quáº£n lÃ½ Tiáº¿p nháº­n

  2. ğŸ¥ Quáº£n lÃ½ PhÃ²ng khÃ¡m  ## âš¡ CÃ i Äáº·t SiÃªu Nhanh

  3. ğŸ©º Quáº£n lÃ½ Dá»‹ch vá»¥

  4. ğŸ‘³ Quáº£n lÃ½ Bá»‡nh nhÃ¢n### ğŸš€ Auto Setup (Khuyáº¿n nghá»‹)

  5. ğŸ‘¨â€âš•ï¸ Quáº£n lÃ½ BÃ¡c sÄ©

  6. ğŸ‘¤ Quáº£n lÃ½ NgÆ°á»i dÃ¹ng**TrÃªn Linux/macOS:**

  7. ğŸ“Š BÃ¡o cÃ¡o & Xuáº¥t Excel```bash

  8. ğŸ›ï¸ Migration dá»¯ liá»‡u# Clone/download project

```chmod +x setup_venv.sh run.sh

./setup_venv.sh    # Thiáº¿t láº­p má»™t láº§n (auto-install dependencies)

### ğŸ‘¤ User Menu:./run.sh           # Cháº¡y á»©ng dá»¥ng (vá»›i giao diá»‡n Ä‘áº¹p)

``````

ğŸ¥ MENU Bá»†NH NHÃ‚N:

  1. ğŸ‘€ Xem thÃ´ng tin dá»‹ch vá»¥**TrÃªn Windows:**

  2. ğŸ¥ Xem thÃ´ng tin phÃ²ng khÃ¡m  ```cmd

  3. ğŸ“ ÄÄƒng kÃ½ khÃ¡m bá»‡nhREM Clone/download project  

  4. ğŸ“‹ Xem lá»‹ch sá»­ khÃ¡msetup_venv.bat     REM Thiáº¿t láº­p má»™t láº§n

  5. ğŸ” Xem lá»‹ch sá»­ khÃ¡m chi tiáº¿trun.bat           REM Cháº¡y á»©ng dá»¥ng

``````



### ğŸ” TÃ­nh NÄƒng Lá»‹ch Sá»­ KhÃ¡m (User):### âš™ï¸ Cáº¥u hÃ¬nh Database

Chá»‰nh sá»­a file `db.py` Ä‘á»ƒ cáº¥u hÃ¬nh káº¿t ná»‘i SQL Server:

**ğŸ“‹ Lá»‹ch sá»­ cÆ¡ báº£n (Option 4):**```python

- Báº£ng formatted: STT, MÃ£ TN, NgÃ y khÃ¡m, Dá»‹ch vá»¥, PhÃ²ng khÃ¡m, BÃ¡c sÄ©, Chi phÃ­# Cáº¥u hÃ¬nh connection string

- Thá»‘ng kÃª: Tá»•ng láº§n khÃ¡m, tá»•ng chi phÃ­conn_str = (

- Xem chi tiáº¿t: Nháº­p STT Ä‘á»ƒ xem thÃ´ng tin Ä‘áº§y Ä‘á»§    "DRIVER={ODBC Driver 13 for SQL Server};"

    "SERVER=HOME\\GIOAN\\SQLEXPRESS;"    # Thay Ä‘á»•i server táº¡i Ä‘Ã¢y

**ğŸ” Lá»‹ch sá»­ chi tiáº¿t (Option 5):**    "DATABASE=DangKyKhamBenh;"

- Xem táº¥t cáº£ lá»‹ch sá»­    "Trusted_Connection=yes;"

- TÃ¬m theo mÃ£ tiáº¿p nháº­n    "TrustServerCertificate=yes;"      # Cho SQL Server 2022+

- Lá»c theo thá»i gian (sáº¯p cÃ³))

```

## ğŸ“± QR Code ThÃ´ng Minh

### ğŸ¯ Sáºµn sÃ¡ng sá»­ dá»¥ng!

Há»‡ thá»‘ng há»— trá»£ nhiá»u Ä‘á»‹nh dáº¡ng QR vÃ  **tá»± Ä‘á»™ng phÃ¢n tÃ­ch CCCD 12 sá»‘**:- âœ… **Database tá»± Ä‘á»™ng**: Khá»Ÿi táº¡o schema + dá»¯ liá»‡u máº«u khi cháº¡y láº§n Ä‘áº§u

- âœ… **Reports folder**: Tá»± Ä‘á»™ng táº¡o cáº¥u trÃºc thÆ° má»¥c bÃ¡o cÃ¡o

### Äá»‹nh dáº¡ng Ä‘áº§y Ä‘á»§:- âœ… **Login ready**: `admin/admin` Ä‘á»ƒ báº¯t Ä‘áº§u

```

CCCD|CMND|HoTen|NgaySinh|GioiTinh|DiaChi---

058186000028|2345678|Nguyá»…n Thá»‹ Linh|15071986|Ná»¯|Ninh Thuáº­n

```## ğŸ“Š TÃNH NÄ‚NG Má»šI: BÃO CÃO & XUáº¤T EXCEL



### Äá»‹nh dáº¡ng tá»‘i thiá»ƒu:### ğŸ¨ Professional Reports System:

``````

CCCD||HoTen|||ğŸ“‹ XUáº¤T DANH SÃCH CÆ  Báº¢N:

058186000028||Nguyá»…n Thá»‹ Linh|||  â€¢ Xuáº¥t danh sÃ¡ch bá»‡nh nhÃ¢n      

```  â€¢ Xuáº¥t danh sÃ¡ch tiáº¿p nháº­n

  â€¢ Xuáº¥t bÃ¡o cÃ¡o dá»‹ch vá»¥

**ğŸ§  PhÃ¢n tÃ­ch thÃ´ng minh CCCD `058186000028`:**  â€¢ Xuáº¥t bÃ¡o cÃ¡o phÃ²ng khÃ¡m  

- `058`: Ninh Thuáº­n (3 sá»‘ Ä‘áº§u)  â€¢ Xuáº¥t bÃ¡o cÃ¡o bÃ¡c sÄ©

- `1`: Ná»¯, tháº¿ ká»· 20 (sá»‘ thá»© 4)

- `86`: NÄƒm sinh 1986 (sá»‘ 5-6)ğŸ“Š BÃO CÃO THá»NG KÃŠ & PHÃ‚N TÃCH:

  â€¢ BÃ¡o cÃ¡o thá»‘ng kÃª tá»•ng há»£p

## ğŸ“Š Há»‡ Thá»‘ng BÃ¡o CÃ¡o  â€¢ BÃ¡o cÃ¡o doanh thu & phÃ¢n tÃ­ch  

  â€¢ BÃ¡o cÃ¡o hoáº¡t Ä‘á»™ng hÃ´m nay

### BÃ¡o cÃ¡o cÆ¡ báº£n:  â€¢ BÃ¡o cÃ¡o tá»•ng há»£p Ä‘a trang

- Danh sÃ¡ch bá»‡nh nhÃ¢n, tiáº¿p nháº­n

- BÃ¡o cÃ¡o dá»‹ch vá»¥, phÃ²ng khÃ¡m, bÃ¡c sÄ©ğŸ“ QUáº¢N LÃ FILE:

  â€¢ Má»Ÿ thÆ° má»¥c bÃ¡o cÃ¡o

### BÃ¡o cÃ¡o nÃ¢ng cao:  â€¢ Dá»n dáº¹p file cÅ© (auto-cleanup)

- Thá»‘ng kÃª tá»•ng há»£p```

- Doanh thu & phÃ¢n tÃ­ch  

- Hoáº¡t Ä‘á»™ng hÃ ng ngÃ y### ğŸ—‚ï¸ Reports Folder Structure:

- BÃ¡o cÃ¡o Ä‘a trang (multi-sheet)```

reports/

### Quáº£n lÃ½ file:â”œâ”€â”€ benh_nhan/          # BÃ¡o cÃ¡o bá»‡nh nhÃ¢n

- Má»Ÿ thÆ° má»¥c bÃ¡o cÃ¡oâ”œâ”€â”€ tiep_nhan/          # BÃ¡o cÃ¡o tiáº¿p nháº­n  

- Tá»± Ä‘á»™ng dá»n dáº¹p file cÅ©â”œâ”€â”€ dich_vu/            # BÃ¡o cÃ¡o dá»‹ch vá»¥

- CSV fallback khi khÃ´ng cÃ³ pandasâ”œâ”€â”€ phong_kham/         # BÃ¡o cÃ¡o phÃ²ng khÃ¡m

â”œâ”€â”€ tong_hop/           # BÃ¡o cÃ¡o tá»•ng há»£p (multi-sheet)

## ğŸ—‚ï¸ Cáº¥u TrÃºc Projectâ”œâ”€â”€ thong_ke/           # BÃ¡o cÃ¡o thá»‘ng kÃª & doanh thu

â””â”€â”€ README.md           # HÆ°á»›ng dáº«n sá»­ dá»¥ng thÆ° má»¥c

``````

cli_khambenh/

â”œâ”€â”€ ğŸ  Core Application### âœ¨ Excel Features:

â”‚   â”œâ”€â”€ app.py              # Main application- ğŸ¨ **Professional styling**: Headers, borders, colors

â”‚   â”œâ”€â”€ db.py               # Database connection- ğŸ“ **Auto-fit columns**: Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh Ä‘á»™ rá»™ng

â”‚   â”œâ”€â”€ models.py           # Data models- ğŸ“Š **Multiple sheets**: BÃ¡o cÃ¡o Ä‘a trang trong 1 file

â”‚   â”œâ”€â”€ repositories.py     # Data access layer- ğŸ“ˆ **Data analysis**: Thá»‘ng kÃª, ranking, tá»•ng há»£p

â”‚   â””â”€â”€ mvc.py              # Controllers- ğŸ’¾ **CSV fallback**: Tá»± Ä‘á»™ng chuyá»ƒn CSV náº¿u khÃ´ng cÃ³ pandas

â”‚- ğŸ·ï¸ **Metadata**: Author, creation date, file info

â”œâ”€â”€ ğŸ¯ Features  

â”‚   â”œâ”€â”€ qr_utils.py         # QR code processing## ğŸ”§ Manual Installation (Alternative)

â”‚   â”œâ”€â”€ report_utils.py     # Reporting system

â”‚   â””â”€â”€ utils/              # Validation, messagesNáº¿u auto-setup khÃ´ng hoáº¡t Ä‘á»™ng, báº¡n cÃ³ thá»ƒ cÃ i Ä‘áº·t thá»§ cÃ´ng:

â”‚

â”œâ”€â”€ ğŸ“Š Setup & Data### 1. Virtual Environment

â”‚   â”œâ”€â”€ requirements.txt    # Dependencies```bash

â”‚   â”œâ”€â”€ setup_venv.sh/.bat  # Auto setuppython3 -m venv venv

â”‚   â”œâ”€â”€ run.sh/.bat         # App launcher

â”‚   â””â”€â”€ import_data.py      # Sample data# Activate

â”‚source venv/bin/activate          # Linux/macOS  

â””â”€â”€ ğŸ“ reports/             # Generated reportsvenv\Scripts\activate            # Windows

    â”œâ”€â”€ benh_nhan/```

    â”œâ”€â”€ tiep_nhan/

    â”œâ”€â”€ dich_vu/### 2. Install Dependencies

    â””â”€â”€ thong_ke/```bash

```pip install --upgrade pip

pip install -r requirements.txt

## ğŸ”§ Troubleshooting

# Verify installation

### Database Connection:python3 -c "import pyodbc; print('âœ… pyodbc OK')"

```bashpython3 -c "import pandas; print('âœ… pandas OK')" 2>/dev/null || echo "âš ï¸  pandas missing"

# Kiá»ƒm tra SQL Server cháº¡y: services.msc â†’ SQL Serverpython3 -c "import openpyxl; print('âœ… openpyxl OK')" 2>/dev/null || echo "âš ï¸  openpyxl missing"

# Test connection: sqlcmd -S HOME\\GIOAN\SQLEXPRESS```

# XÃ¡c nháº­n connection string trong db.py

```### 3. ODBC Driver Installation



### ODBC Driver:**Windows**: Download tá»« Microsoft

```bash**Linux**: 

# Install ODBC Driver 13 for SQL Server```bash

# Windows: Download tá»« Microsoft# Ubuntu/Debian

# macOS: brew install msodbcsql17curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -

# Linux: apt-get install msodbcsql17curl https://packages.microsoft.com/config/ubuntu/20.04/prod.list > /etc/apt/sources.list.d/mssql-release.list

```apt-get update && ACCEPT_EULA=Y apt-get install -y msodbcsql17

```

### Excel Export:

```bash**macOS**:

# Install dependencies```bash

pip install pandas openpyxlbrew tap microsoft/mssql-release https://github.com/Microsoft/homebrew-mssql-release  

HOMEBREW_NO_ENV_FILTERING=1 ACCEPT_EULA=Y brew install msodbcsql17

# Náº¿u lá»—i: há»‡ thá»‘ng tá»± chuyá»ƒn CSV```

```

---

## ğŸš€ Hiá»‡u Suáº¥t

## ğŸ¯ HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

- **Small data** (<1K records): ~1-2s  

- **Medium data** (1K-10K): ~3-5s## ğŸ¯ HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

- **Large data** (>10K): ~10-30s

- **Medical history**: ~0.5-2s (optimized)### ğŸ” ÄÄƒng nháº­p:

- **ğŸ‘¨â€ğŸ’¼ Admin**: `admin` / `admin` (Full access + Reports + Management)

## ğŸ“„ License- **ğŸ‘¤ User**: Sá»­ dá»¥ng CCCD/password Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng (Enhanced medical history access)



MIT License - Professional healthcare management system.### ï¿½â€ğŸ’¼ Admin Role Features:

```

---ğŸ¥ Há»† THá»NG QUáº¢N LÃ KHÃM Bá»†NH - MENU QUáº¢N TRá»Š VIÃŠN:

  1. ğŸ“‹ Quáº£n lÃ½ Tiáº¿p nháº­n

**ğŸ¥ Há»‡ Thá»‘ng Quáº£n LÃ½ KhÃ¡m Bá»‡nh** - Production-ready vá»›i comprehensive features.  2. ğŸ¥ Quáº£n lÃ½ PhÃ²ng khÃ¡m  

  3. ğŸ©º Quáº£n lÃ½ Dá»‹ch vá»¥

*Sáºµn sÃ ng triá»ƒn khai! ğŸš€*  4. ğŸ‘³ Quáº£n lÃ½ Bá»‡nh nhÃ¢n
  5. ğŸ‘¨â€âš•ï¸ Quáº£n lÃ½ BÃ¡c sÄ©
  6. ğŸ‘¤ Quáº£n lÃ½ NgÆ°á»i dÃ¹ng
  7. ğŸ“Š BÃ¡o cÃ¡o & Xuáº¥t Excel
  8. ğŸ›ï¸ Migration dá»¯ liá»‡u tá»‰nh bá»‡nh nhÃ¢n
  0. ğŸšª ÄÄƒng xuáº¥t
```

### ï¿½ğŸ‘¤ User Role Features (Bá»‡nh nhÃ¢n):
```
ğŸ¥ Há»† THá»NG ÄÄ‚NG KÃ KHÃM Bá»†NH - MENU Bá»†NH NHÃ‚N:
  1. ğŸ‘€ Xem thÃ´ng tin dá»‹ch vá»¥
  2. ğŸ¥ Xem thÃ´ng tin phÃ²ng khÃ¡m  
  3. ğŸ“ ÄÄƒng kÃ½ khÃ¡m bá»‡nh
  4. ğŸ“‹ Xem lá»‹ch sá»­ khÃ¡m
  5. ğŸ” Xem lá»‹ch sá»­ khÃ¡m chi tiáº¿t
  0. ğŸšª ÄÄƒng xuáº¥t
```

#### **ğŸ†• TÃ­nh nÄƒng Lá»‹ch sá»­ khÃ¡m nÃ¢ng cao:**

**ğŸ“‹ Xem lá»‹ch sá»­ khÃ¡m cÆ¡ báº£n (Option 4):**
- Hiá»ƒn thá»‹ báº£ng formatted vá»›i thÃ´ng tin: STT, MÃ£ tiáº¿p nháº­n, NgÃ y khÃ¡m, Dá»‹ch vá»¥, PhÃ²ng khÃ¡m, BÃ¡c sÄ©, Chi phÃ­
- Thá»‘ng kÃª tá»•ng sá»‘ láº§n khÃ¡m vÃ  tá»•ng chi phÃ­
- TÃ¹y chá»n nháº­p STT Ä‘á»ƒ xem chi tiáº¿t tá»«ng láº§n khÃ¡m
- ThÃ´ng tin bá»‡nh nhÃ¢n á»Ÿ header (tÃªn, giá»›i tÃ­nh, nÄƒm sinh, CCCD)

**ğŸ” Xem lá»‹ch sá»­ khÃ¡m chi tiáº¿t (Option 5):**
- Menu con vá»›i 3 tÃ¹y chá»n:
  - ğŸ“‹ Xem táº¥t cáº£ lá»‹ch sá»­
  - ğŸ” TÃ¬m theo mÃ£ tiáº¿p nháº­n cá»¥ thá»ƒ  
  - ğŸ“… Lá»c theo khoáº£ng thá»i gian (coming soon)

**ğŸ“ Chi tiáº¿t tá»«ng láº§n khÃ¡m:**
- ThÃ´ng tin Ä‘áº§y Ä‘á»§: bá»‡nh nhÃ¢n, dá»‹ch vá»¥, phÃ²ng khÃ¡m, bÃ¡c sÄ©
- MÃ£ tiáº¿p nháº­n, lÃ½ do khÃ¡m, ngÃ y giá» chÃ­nh xÃ¡c
- Giao diá»‡n thÃ¢n thiá»‡n vá»›i emoji vÃ  formatting

### ğŸ“± QR Code ThÃ´ng Minh:

#### **CÃ¡ch 1: Through Menu**
```
Admin Menu â†’ Quáº£n lÃ½ Tiáº¿p nháº­n â†’ QuÃ©t QR code Ä‘Äƒng kÃ½
```

#### **CÃ¡ch 2: User Registration** 
```
User Menu â†’ ÄÄƒng kÃ½ khÃ¡m bá»‡nh â†’ Nháº­p QR code
```

### ğŸ“Š BÃ¡o CÃ¡o & Excel Export:
```
Admin Menu â†’ BÃ¡o cÃ¡o & Xuáº¥t Excel â†’ [Chá»n loáº¡i bÃ¡o cÃ¡o]
```
- ğŸ“ˆ **Thá»‘ng kÃª tá»•ng há»£p**: Overview toÃ n há»‡ thá»‘ng
- ğŸ’° **Doanh thu phÃ¢n tÃ­ch**: Revenue by services + ranking  
- ğŸ“… **Hoáº¡t Ä‘á»™ng hÃ ng ngÃ y**: Daily operations report
- ğŸ“‹ **Multi-sheet reports**: Comprehensive analysis

### ğŸ“ File Management:
- **Má»Ÿ thÆ° má»¥c**: Trá»±c tiáº¿p má»Ÿ folder reports tá»« app
- **Cleanup**: Tá»± Ä‘á»™ng dá»n dáº¹p file cÅ© theo ngÃ y

---

## ğŸ” QR Code Formats

**ğŸ”¥ TÃ­nh nÄƒng má»›i: PhÃ¢n tÃ­ch thÃ´ng minh CCCD 12 sá»‘**

Há»‡ thá»‘ng há»— trá»£ nhiá»u Ä‘á»‹nh dáº¡ng QR code:

#### **1. Äá»‹nh dáº¡ng Ä‘áº§y Ä‘á»§:**
```
CCCD|CMND|HoTen|NgaySinh|GioiTinh|DiaChi
```
VÃ­ dá»¥:
```
058186000028|2345678|Nguyá»…n Thá»‹ Linh|15071986|Ná»¯|Ninh Thuáº­n
```

#### **2. Äá»‹nh dáº¡ng tá»‘i thiá»ƒu (âœ¨ Má»›i):**
```
CCCD||HoTen|||
```
VÃ­ dá»¥:
```
058186000028||Nguyá»…n Thá»‹ Linh|||
```

**ğŸ§  PhÃ¢n tÃ­ch thÃ´ng minh:** Khi thÃ´ng tin QR khÃ´ng Ä‘áº§y Ä‘á»§, há»‡ thá»‘ng sáº½ **tá»± Ä‘á»™ng phÃ¢n tÃ­ch sá»‘ CCCD 12 chá»¯ sá»‘** Ä‘á»ƒ trÃ­ch xuáº¥t:
- ğŸ—ºï¸ **Tá»‰nh/TP khai sinh** (3 sá»‘ Ä‘áº§u)
- ğŸ‘« **Giá»›i tÃ­nh** (sá»‘ thá»© 4: 0/2=Nam, 1/3=Ná»¯)  
- ğŸ‚ **NÄƒm sinh** (sá»‘ thá»© 5-6 + tháº¿ ká»· tá»« sá»‘ thá»© 4)

**VÃ­ dá»¥ CCCD `058186000028`:**
- `058`: Ninh Thuáº­n
- `1`: Ná»¯, tháº¿ ká»· 20 (1900-1999)
- `86`: NÄƒm sinh 1986
- `000028`: Sá»‘ Ä‘á»‹nh danh cÃ¡ nhÃ¢n

ğŸ“ **Cáº¥u TrÃºc Project**

```
cli_khambenh/
â”œâ”€â”€ ğŸ  Core Application
â”‚   â”œâ”€â”€ app.py              # Main application vá»›i enhanced UI + User menu nÃ¢ng cao
â”‚   â”œâ”€â”€ db.py               # Database connection & init
â”‚   â”œâ”€â”€ models.py           # ORM models vá»›i validation + TiepNhan with timestamps
â”‚   â”œâ”€â”€ repositories.py     # Data access layer + Enhanced medical history queries
â”‚   â”œâ”€â”€ mvc.py              # MVC controllers + Advanced medical history views
â”‚   â””â”€â”€ validation_utils.py # Input validation helpers
â”‚
â”œâ”€â”€ ğŸ¯ Features  
â”‚   â”œâ”€â”€ qr_utils.py         # QR code processing + CCCD analysis
â”‚   â”œâ”€â”€ report_utils.py     # ğŸ†• Professional reporting system
â”‚   â”œâ”€â”€ migration_hanh_chinh.py # Admin data migration
â”‚   â””â”€â”€ admin_migration_menu.py # Migration UI
â”‚
â”œâ”€â”€ ğŸ“Š Data & Config
â”‚   â”œâ”€â”€ database_schema.sql # Complete DB schema
â”‚   â”œâ”€â”€ import_data.py      # Sample data initialization  
â”‚   â”œâ”€â”€ requirements.txt    # Enhanced dependencies
â”‚   â””â”€â”€ DEPLOYMENT.md       # Deployment guide
â”‚
â”œâ”€â”€ ğŸš€ Setup & Run
â”‚   â”œâ”€â”€ setup_venv.sh       # ğŸ†• Enhanced Linux/macOS setup
â”‚   â”œâ”€â”€ setup_venv.bat      # ğŸ†• Enhanced Windows setup  
â”‚   â”œâ”€â”€ run.sh              # ğŸ†• Smart app launcher (Unix)
â”‚   â”œâ”€â”€ run.bat             # ğŸ†• Smart app launcher (Windows)
â”‚   â””â”€â”€ README_SETUP.md     # ğŸ†• Detailed setup guide
â”‚
â””â”€â”€ ğŸ“ Generated
    â””â”€â”€ reports/            # ğŸ†• Auto-created reports folder
        â”œâ”€â”€ benh_nhan/
        â”œâ”€â”€ tiep_nhan/ 
        â”œâ”€â”€ dich_vu/
        â”œâ”€â”€ phong_kham/
        â”œâ”€â”€ tong_hop/
        â”œâ”€â”€ thong_ke/
        â””â”€â”€ README.md       # Reports usage guide
```

### ğŸ†• New Files (Recent Updates):
- âœ¨ **Enhanced mvc.py**: Advanced medical history controllers with detail views
- âœ¨ **Updated models.py**: TiepNhan model with timestamp support
- âœ¨ **Enhanced repositories.py**: Optimized queries for medical history
- âœ¨ **report_utils.py**: Comprehensive reporting engine
- ğŸ¨ **Enhanced setup scripts**: Interactive, colorful, smart error handling
- ğŸ“Š **Reports system**: Auto-organized file structure  
- ğŸ› ï¸ **README_SETUP.md**: Detailed setup instructions

## ï¿½ï¸ Troubleshooting

### âŒ Database Connection Issues:
```bash
# Error: "Can't connect to SQL Server"
# Solutions:
1. Kiá»ƒm tra SQL Server Ä‘Ã£ cháº¡y: services.msc â†’ SQL Server
2. XÃ¡c nháº­n connection string trong db.py  
3. Test connection: sqlcmd -S HOME\\GIOAN\SQLEXPRESS
4. Firewall: Allow SQL Server port 1433
```

### âŒ ODBC Driver Issues:
```bash
# Error: "Can't open lib 'ODBC Driver 13 for SQL Server'"
# Solutions:
1. Install ODBC Driver 17 (hÆ°á»›ng dáº«n trÃªn)
2. macOS: brew install unixodbc
3. Linux: apt-get install unixodbc unixodbc-dev
```

### âŒ Excel Export Issues:
```bash  
# Error: "No module named 'pandas'" 
pip install pandas openpyxl

# Error: "Excel styling not working"
# Check: Náº¿u khÃ´ng cÃ³ openpyxl, há»‡ thá»‘ng sáº½ tá»± chuyá»ƒn CSV

# Error: "Cannot save file into non-existent directory" 
# Fix: ÄÃ£ Ä‘Æ°á»£c fix trong phiÃªn báº£n hiá»‡n táº¡i (auto-create directories)
```

### âŒ Permission Issues:
```bash
# Linux/macOS: Make scripts executable  
chmod +x setup_venv.sh run.sh

# Windows: Run as Administrator náº¿u cáº§n
```

### ğŸ” Debug Mode:
```python
# ThÃªm vÃ o db.py Ä‘á»ƒ debug connection
print(f"Connecting to: {conn_str}")
```

## ğŸš€ Performance & Features

### âš¡ System Requirements:
- **RAM**: 2GB+ (4GB+ khuyáº¿n nghá»‹ cho large reports)
- **Storage**: 500MB+ (reports cÃ³ thá»ƒ tá»‘n nhiá»u dung lÆ°á»£ng)
- **CPU**: Any modern CPU (Excel generation cÃ³ thá»ƒ tá»‘n CPU)

### ğŸ“Š Reporting Performance:
- **Small data** (< 1000 records): ~1-2 seconds  
- **Medium data** (1000-10000 records): ~3-5 seconds
- **Large data** (10000+ records): ~10-30 seconds
- **Multi-sheet reports**: Add ~2-3 seconds per sheet
- **Medical history queries**: ~0.5-2 seconds (optimized with proper indexing)

### ğŸ”„ Data Limits:
- **Bá»‡nh nhÃ¢n**: Unlimited (limited by SQL Server)
- **Medical history records**: Unlimited vá»›i pagination support
- **Excel sheets**: ~1M rows per sheet (Excel limit)
- **CSV files**: Unlimited  
- **File cleanup**: Auto-delete files >30 days (configurable)
- **Search results**: Optimized for fast retrieval vá»›i database indexing

---

## ğŸ¤ Contributing & Development

### ğŸ”§ Development Setup:
```bash
# Clone + setup development environment
git clone [repository]
cd cli_khambenh
./setup_venv.sh
# Start coding!
```

### ğŸ“ Code Structure:
- **MVC Pattern**: Separation of concerns
- **Repository Pattern**: Data access abstraction  
- **Validation Layer**: Input sanitization & validation
- **Error Handling**: Comprehensive try-catch vá»›i user-friendly messages

### ğŸ§ª Testing:
- **Manual testing**: Use sample data  
- **QR Code testing**: Use provided examples
- **Excel testing**: Check vá»›i/khÃ´ng pandas
- **Database testing**: Multiple SQL Server versions

### ğŸ¯ Future Enhancements:
- [ ] Web UI (Flask/FastAPI)
- [ ] REST API endpoints
- [ ] Advanced analytics (charts, graphs)
- [ ] Email reports scheduling  
- [ ] Multi-language support
- [ ] Mobile QR scanning app integration
- [ ] **âœ… Enhanced User Medical History** (Completed)
- [ ] Time-based filtering for medical history
- [ ] Medical history export for users
- [ ] Appointment scheduling system
- [ ] SMS/Email notifications

---

## ğŸ“„ License & Support

### ğŸ“œ License:
MIT License - Xem file LICENSE Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.

### ğŸ“ Há»— Trá»£:
- ğŸ› **Bug Reports**: Táº¡o issue trÃªn GitHub vá»›i detailed description
- ğŸ’¡ **Feature Requests**: GitHub discussions hoáº·c issues  
- ğŸ“§ **Email Support**: Contact repository owner
- ğŸ“š **Documentation**: README.md + README_SETUP.md + inline comments

### ğŸ¯ Quick Links:
- **Setup Guide**: `README_SETUP.md` (detailed installation)
- **Database Schema**: `database_schema.sql`
- **Sample Data**: `import_data.py`  
- **Migration Tools**: `migration_hanh_chinh.py`

---

## ğŸ‰ Changelog & Updates

### ğŸ†• Recent Updates (Latest):
- âœ… **Enhanced User Medical History System**: Professional medical history viewing with detailed information
  - ğŸ“‹ Formatted table display with comprehensive information
  - ğŸ” Advanced detail view with search and filter capabilities
  - ğŸ“Š Personal statistics (total visits, total costs)
  - ğŸ—“ï¸ Accurate date/time information from database
  - ğŸ” Search by appointment code functionality
  - ğŸ“ Detailed individual visit information
  - ğŸ¨ Smart text formatting and user-friendly interface
- âœ… **Professional Reporting System**: 11 report types vá»›i Excel styling
- âœ… **Enhanced Setup Scripts**: Interactive, colorful, smart error handling
- âœ… **Auto Directory Creation**: Fix for "non-existent directory" errors
- âœ… **File Management**: Auto cleanup, open folder from app  
- âœ… **CSV Fallback**: Graceful degradation when pandas unavailable
- âœ… **Multi-sheet Reports**: Comprehensive analysis in single file
- âœ… **Revenue Analysis**: Detailed service-based revenue reports

### ğŸ”„ Previous Updates:
- âœ… QR Code intelligent analysis (CCCD parsing)
- âœ… Enhanced user registration flow
- âœ… Admin/User role separation with specialized menus
- âœ… Comprehensive validation system
- âœ… MVC architecture implementation
- âœ… Database schema optimization
- âœ… Professional UI/UX improvements

---

**ğŸ¥ Há»‡ Thá»‘ng Quáº£n LÃ½ KhÃ¡m Bá»‡nh** - Professional healthcare management vá»›i modern reporting capabilities vÃ  enhanced user experience.

*Ready for production use! ğŸš€*

### ğŸ¯ Key Highlights:
- âœ… **Dual-role system**: Comprehensive admin tools + Enhanced patient portal
- âœ… **Smart medical history**: Advanced viewing, searching, and statistics
- âœ… **Professional reporting**: 11 types of Excel reports with styling
- âœ… **QR code intelligence**: Automatic patient data extraction
- âœ… **User-friendly interface**: Intuitive menus with emoji and formatting
- âœ… **Production-ready**: Comprehensive error handling and validation